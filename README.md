# Anyi 自动化脚本

这是一个用于自动化操作 Anyi 应用程序的 Python 脚本，实现了进程管理、文件操作、程序运行和图像自动化等功能。

## 功能特点

1. **进程管理**
   - 自动检查并结束 Anyi.exe 和 anyi-core.exe 进程
   - 具有进程存在性检查机制
   - 支持强制终止无响应进程

2. **文件操作**
   - 动态获取当前系统用户名
   - 自动删除用户 .config 文件夹
   - 包含文件夹存在性验证和删除结果确认

3. **程序运行**
   - 配置文件存储机制（JSON格式）
   - 路径输入验证（正则表达式校验）
   - 可执行文件启动状态检测
   - 失败重试机制（最多3次尝试）

4. **图像自动化**
   - 集成 pyautogui 进行图像识别
   - 智能等待机制（带超时的循环检测）
   - 多重定位策略（区域限定+置信度调节）
   - 抗干扰点击逻辑（随机偏移点击位置）
   - 全局监控机制（检测7.png弹窗）

5. **输入法处理**
   - 生成符合规范的随机字符串（大小写混合）
   - 安全输入模式（自动切换英文输入法）
   - 输入验证机制和异常恢复策略

## 安装步骤

1. 确保已安装 Python 3.8 或更高版本
2. 克隆或下载此仓库到本地
3. 安装所需依赖包：

```bash
pip install -r requirements.txt
```

## 使用方法

1. 运行主程序：

```bash
python anyi_main.py
```

2. 首次运行时，程序会提示输入 Anyi.exe 的完整路径
3. 程序会自动执行以下操作：
   - 结束已运行的 Anyi 相关进程
   - 删除配置文件夹
   - 运行指定的 Anyi.exe 程序
   - 执行一系列图像识别和点击操作

## 注意事项

- 确保 images 文件夹中包含所有需要的图片文件（1.png 到 7.png）
- 程序运行过程中请勿移动鼠标或使用键盘，以免干扰自动化操作
- 日志文件 anyi_automation.log 会记录程序运行的详细信息

## 系统要求

- 操作系统：Windows 10/11
- Python 3.8+
- 依赖库：psutil, pyautogui, pyperclip, Pillow, keyboard